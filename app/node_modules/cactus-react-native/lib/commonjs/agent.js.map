{"version":3,"names":["_lm","require","_tools","CactusAgent","CactusLM","init","params","onProgress","cactusToken","retryOptions","result","error","lm","agent","Object","setPrototypeOf","prototype","tools","Tools","addTool","func","description","parameters","add","getTools","completionWithTools","messages","callback","recursionCount","recursionLimit","length","completion","getSchemas","jinja","newMessages","requiresReset","conversationHistoryManager","processNewMessages","context","rewind","reset","update","role","content","tool_calls","isJinjaSupported","exports"],"sourceRoot":"../../src","sources":["agent.ts"],"mappings":";;;;;;AAAA,IAAAA,GAAA,GAAAC,OAAA;AAUA,IAAAC,MAAA,GAAAD,OAAA;AAkBO,MAAME,WAAW,SAASC,YAAQ,CAAC;EAGxC,aAAaC,IAAIA,CACfC,MAAqB,EACrBC,UAAuC,EACvCC,WAAoB,EACpBC,YAAwD,EAC5B;IAC5B,MAAMC,MAAM,GAAG,MAAMN,YAAQ,CAACC,IAAI,CAACC,MAAM,EAAEC,UAAU,EAAEC,WAAW,EAAEC,YAAY,CAAC;IAEjF,IAAIC,MAAM,CAACC,KAAK,IAAI,CAACD,MAAM,CAACE,EAAE,EAAE;MAC9B,OAAO;QAAEC,KAAK,EAAE,IAAI;QAAEF,KAAK,EAAED,MAAM,CAACC,KAAK;QAAEC,EAAE,EAAE;MAAK,CAAC;IACvD;IAEA,MAAMC,KAAK,GAAGC,MAAM,CAACC,cAAc,CAACL,MAAM,CAACE,EAAE,EAAET,WAAW,CAACa,SAAS,CAAgB;IACpFH,KAAK,CAACI,KAAK,GAAG,IAAIC,YAAK,CAAC,CAAC;IACzB,OAAO;MAAEL,KAAK;MAAEF,KAAK,EAAE,IAAI;MAAEC,EAAE,EAAEC;IAAM,CAAC;EAC1C;EAEAM,OAAOA,CACLC,IAAc,EACdC,WAAmB,EACnBC,UAAwC,EAC9B;IACV,OAAO,IAAI,CAACL,KAAK,CAACM,GAAG,CAACH,IAAI,EAAEC,WAAW,EAAEC,UAAU,CAAC;EACtD;EAEAE,QAAQA,CAAA,EAAU;IAChB,OAAO,IAAI,CAACP,KAAK;EACnB;EAEA,MAAMQ,mBAAmBA,CACvBC,QAAsC,EACtCpB,MAA6B,GAAG,CAAC,CAAC,EAClCqB,QAAoC,EACpCC,cAAsB,GAAG,CAAC,EAC1BC,cAAsB,GAAG,CAAC,EACO;IACjC,MAAMZ,KAAK,GAAGX,MAAM,CAACW,KAAK,IAAI,IAAI,CAACA,KAAK;IAExC,IAAI,CAACS,QAAQ,EAAEI,MAAM,EAAE;MACrB,OAAO,IAAI,CAACC,UAAU,CAAC,EAAE,EAAEzB,MAAM,EAAEqB,QAAQ,CAAC;IAC9C;IACA,IAAI,CAACV,KAAK,IAAIA,KAAK,CAACe,UAAU,CAAC,CAAC,CAACF,MAAM,KAAK,CAAC,EAAE;MAC7C,OAAO,IAAI,CAACC,UAAU,CAACL,QAAQ,EAAEpB,MAAM,EAAEqB,QAAQ,CAAC;IACpD;IACA,IAAIC,cAAc,IAAIC,cAAc,EAAE;MACpC,OAAO,IAAI,CAACE,UAAU,CAACL,QAAQ,EAAE;QAC/B,GAAGpB,MAAM;QACT2B,KAAK,EAAE,IAAI;QACXhB,KAAK,EAAEA,KAAK,CAACe,UAAU,CAAC;MAC1B,CAAC,EAAEL,QAAQ,CAAC;IACd;IAEA,MAAM;MAAEO,WAAW;MAAEC;IAAc,CAAC,GAClC,IAAI,CAACC,0BAA0B,CAACC,kBAAkB,CAACX,QAAQ,CAAC;IAE9D,IAAIS,aAAa,EAAE;MACjB,IAAI,CAACG,OAAO,EAAEC,MAAM,CAAC,CAAC;MACtB,IAAI,CAACH,0BAA0B,CAACI,KAAK,CAAC,CAAC;IACzC;IAEA,MAAM9B,MAAM,GAAG,MAAM,IAAI,CAAC4B,OAAO,CAACb,mBAAmB,CAAC;MACpD,GAAGnB,MAAM;MACToB,QAAQ,EAAEQ,WAAW,CAACJ,MAAM,GAAG,CAAC,GAAGI,WAAW,GAAGR,QAAQ;MACzDT,KAAK,EAAEA;IACT,CAAC,EAAEU,QAAQ,EAAEC,cAAc,EAAEC,cAAc,CAAC;IAE5C,IAAI,CAACO,0BAA0B,CAACK,MAAM,CACpCP,WAAW,CAACJ,MAAM,GAAG,CAAC,GAAGI,WAAW,GAAGR,QAAQ,EAC/C;MACEgB,IAAI,EAAE,WAAW;MACjBC,OAAO,EAAEjC,MAAM,CAACiC,OAAO;MACvBC,UAAU,EAAElC,MAAM,CAACkC;IACrB,CACF,CAAC;IAED,OAAOlC,MAAM;EACf;EACAmC,gBAAgBA,CAAA,EAAY;IAC1B,OAAO,IAAI,CAACP,OAAO,CAACO,gBAAgB,CAAC,CAAC;EACxC;AACF;AAACC,OAAA,CAAA3C,WAAA,GAAAA,WAAA","ignoreList":[]}
