{"version":3,"names":["CactusLM","Tools","CactusAgent","init","params","onProgress","cactusToken","retryOptions","result","error","lm","agent","Object","setPrototypeOf","prototype","tools","addTool","func","description","parameters","add","getTools","completionWithTools","messages","callback","recursionCount","recursionLimit","length","completion","getSchemas","jinja","newMessages","requiresReset","conversationHistoryManager","processNewMessages","context","rewind","reset","update","role","content","tool_calls","isJinjaSupported"],"sourceRoot":"../../src","sources":["agent.ts"],"mappings":"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","ignoreList":[]}
